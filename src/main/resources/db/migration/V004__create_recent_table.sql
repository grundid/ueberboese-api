CREATE TABLE IF NOT EXISTS RECENT (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ACCOUNT_ID VARCHAR(255) NOT NULL,
    NAME VARCHAR(512) NOT NULL,
    LOCATION VARCHAR(512) NOT NULL,
    SOURCE_ID VARCHAR(255) NOT NULL,
    CONTENT_ITEM_TYPE VARCHAR(50) NOT NULL,
    DEVICE_ID VARCHAR(255) NOT NULL,
    LAST_PLAYED_AT TIMESTAMP WITH TIME ZONE NOT NULL,
    CREATED_ON TIMESTAMP WITH TIME ZONE NOT NULL,
    UPDATED_ON TIMESTAMP WITH TIME ZONE NOT NULL,
    VERSION BIGINT NOT NULL DEFAULT 0,
    CONSTRAINT UQ_RECENT_ACCOUNT_LOCATION_SOURCE
        UNIQUE (ACCOUNT_ID, LOCATION, SOURCE_ID)
);

CREATE INDEX IF NOT EXISTS IDX_RECENT_ACCOUNT_LAST_PLAYED
    ON RECENT(ACCOUNT_ID, LAST_PLAYED_AT DESC);
